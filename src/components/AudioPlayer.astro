---
// src/components/AudioPlayer.astro
import 'plyr/dist/plyr.css';

export interface Props {
  src: string;
}

const { src } = Astro.props;
---

<audio class="custom-audio-player" controls src={src}>
  您的浏览器不支持音频播放。
</audio>

<script>
  // 错误就在下面这一行，我们来修复它
  import Plyr from 'plyr';

  // 确保这段脚本只在页面加载完成后运行
  document.addEventListener('DOMContentLoaded', () => {
    try {
      const players = Array.from(document.querySelectorAll('.custom-audio-player'));
      players.forEach(player => {
        // @ts-ignore - 明确告诉 TypeScript 我们知道 Plyr 是一个构造函数
        new Plyr(player as HTMLElement);
      });
    } catch (e) {
      console.error("Error initializing Plyr:", e);
    }
  });
</script>

<style is:global>
  :root {
    --plyr-color-main: #1877F2; 
  }
</style>