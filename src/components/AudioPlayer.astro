---
// src/components/AudioPlayer.astro

// 1. 导入 Plyr 的 CSS 样式文件，这是让播放器变好看的关键
import 'plyr/dist/plyr.css';

// 2. 定义这个组件需要接收哪些参数（Props）
// 在这里，我们只需要一个 `src`，也就是音频文件的路径
export interface Props {
  src: string;
}

// 3. 从 Astro.props 中获取传入的 src
const { src } = Astro.props;
---

<!-- 4. 这是播放器的 HTML 结构。我们使用一个普通的 <audio> 标签，
     并给它一个特定的 class，方便稍后的脚本找到它。 -->
<audio class="custom-audio-player" controls src={src}>
  您的浏览器不支持音频播放。
</audio>

<!-- 5. 这是在浏览器端运行的脚本，用来初始化 Plyr -->
<script>
  // 导入 Plyr 库
  import Plyr from 'plyr';

  // 寻找页面上所有 class 为 .custom-audio-player 的元素
  const players = Array.from(document.querySelectorAll('.custom-audio-player'));
  
  // 遍历并为每一个元素初始化 Plyr 播放器
  players.map(player => new Plyr(player as HTMLElement));
</script>

<!-- (可选) 6. 在这里轻松地自定义播放器的主题颜色 -->
<style is:global>
  :root {
    /* 将 #1877F2 替换为您网站的主题颜色 */
    --plyr-color-main: #1877F2; 
  }
</style>